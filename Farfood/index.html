<!DOCTYPE html>
<html lang="es">

<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <meta name="description"
        content="FarFood - Planificador inteligente de dieta alimentaria con c√°lculo autom√°tico de porciones">
    <title>FarFood - Planificador Inteligente de Dieta</title>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link
        href="https://fonts.googleapis.com/css2?family=Inter:wght@300;400;500;600;700;800&family=Outfit:wght@400;500;600;700;800&display=swap"
        rel="stylesheet">
    <link rel="stylesheet" href="styles.css">
</head>

<body>
    <!-- Animated Background -->
    <div class="bg-gradient"></div>
    <div class="bg-particles" id="particles"></div>

    <!-- Header -->
    <header class="header" id="header">
        <div class="header-inner">
            <div class="logo">
                <div class="logo-icon">
                    <svg width="32" height="32" viewBox="0 0 32 32" fill="none">
                        <circle cx="16" cy="16" r="14" stroke="url(#logoGrad)" stroke-width="2.5" />
                        <path d="M10 18C10 14 13 10 16 10C19 10 22 14 22 18" stroke="url(#logoGrad)" stroke-width="2"
                            stroke-linecap="round" />
                        <circle cx="16" cy="13" r="2" fill="url(#logoGrad)" />
                        <path d="M12 20H20" stroke="url(#logoGrad)" stroke-width="2" stroke-linecap="round" />
                        <defs>
                            <linearGradient id="logoGrad" x1="0" y1="0" x2="32" y2="32">
                                <stop stop-color="#6366f1" />
                                <stop offset="1" stop-color="#a855f7" />
                            </linearGradient>
                        </defs>
                    </svg>
                </div>
                <span class="logo-text">FarFood</span>
            </div>
            <nav class="nav">
                <button class="nav-btn active" data-section="diet" id="nav-diet">
                    <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                        stroke-linecap="round" stroke-linejoin="round">
                        <path d="M12 2L2 7l10 5 10-5-10-5z" />
                        <path d="M2 17l10 5 10-5" />
                        <path d="M2 12l10 5 10-5" />
                    </svg>
                    <span>Mi Dieta</span>
                </button>
                <button class="nav-btn" data-section="foods" id="nav-foods">
                    <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                        stroke-linecap="round" stroke-linejoin="round">
                        <path d="M18 8h1a4 4 0 010 8h-1" />
                        <path d="M2 8h16v9a4 4 0 01-4 4H6a4 4 0 01-4-4V8z" />
                        <line x1="6" y1="1" x2="6" y2="4" />
                        <line x1="10" y1="1" x2="10" y2="4" />
                        <line x1="14" y1="1" x2="14" y2="4" />
                    </svg>
                    <span>Alimentos</span>
                </button>
                <button class="nav-btn" data-section="calculator" id="nav-calculator">
                    <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                        stroke-linecap="round" stroke-linejoin="round">
                        <path d="M4 15s1-1 4-1 5 2 8 2 4-1 4-1V3s-1 1-4 1-5-2-8-2-4 1-4 1z" />
                        <line x1="4" y1="22" x2="4" y2="15" />
                    </svg>
                    <span>Calculadora IA</span>
                </button>
            </nav>
        </div>
    </header>

    <!-- Main Content -->
    <main class="main">
        <!-- ==================== SECTION: MI DIETA ==================== -->
        <section class="section active" id="section-diet">
            <div class="section-header">
                <div class="section-header-row">
                    <div>
                        <h1>Mi Plan de Dieta</h1>
                        <p class="section-subtitle">Configur√° tus comidas diarias con los objetivos de calor√≠as y
                            macronutrientes</p>
                    </div>
                    <button class="btn btn-import" id="btn-open-import">
                        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                            stroke-width="2" stroke-linecap="round">
                            <path d="M21 15v4a2 2 0 01-2 2H5a2 2 0 01-2-2v-4" />
                            <polyline points="17 8 12 3 7 8" />
                            <line x1="12" y1="3" x2="12" y2="15" />
                        </svg>
                        üìÑ Importar Dieta con IA
                    </button>
                </div>
            </div>

            <!-- Import Diet Panel -->
            <div class="import-panel glass-card hidden" id="import-panel">
                <div class="import-header">
                    <div class="import-title-row">
                        <span class="import-icon">ü§ñ</span>
                        <div>
                            <h2>Importar Dieta desde Imagen o PDF</h2>
                            <p>Sub√≠ fotos o un PDF de tu dieta y la IA extraer√° las comidas, opciones y macros
                                autom√°ticamente</p>
                        </div>
                    </div>
                    <button class="modal-close" id="btn-close-import">&times;</button>
                </div>

                <div class="import-api-key">
                    <label for="gemini-api-key">üîë API Key de Google Gemini <a
                            href="https://aistudio.google.com/app/apikey" target="_blank"
                            style="color:var(--primary-400);font-size:0.75rem;">(Obtener gratis)</a></label>
                    <input type="password" id="gemini-api-key" placeholder="Peg√° tu API Key de Gemini ac√°...">
                </div>

                <div class="import-dropzone" id="import-dropzone">
                    <input type="file" id="import-file-input" accept="image/*,.pdf" multiple hidden>
                    <div class="dropzone-content">
                        <div class="dropzone-icon">üì∏</div>
                        <p class="dropzone-text">Arrastr√° im√°genes o PDF ac√°, o hac√© click para seleccionar</p>
                        <p class="dropzone-hint">Soporta: JPG, PNG, WEBP, PDF</p>
                    </div>
                </div>

                <div class="import-previews" id="import-previews"></div>

                <div class="import-actions">
                    <button class="btn btn-primary btn-analyze" id="btn-analyze" disabled>
                        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                            stroke-width="2" stroke-linecap="round">
                            <polygon points="13 2 3 14 12 14 11 22 21 10 12 10 13 2" />
                        </svg>
                        Analizar con IA
                    </button>
                </div>

                <div class="import-loading hidden" id="import-loading">
                    <div class="loading-spinner"></div>
                    <p>Analizando tu dieta con Gemini AI...</p>
                </div>

                <div class="import-result hidden" id="import-result">
                    <!-- Filled by JS -->
                </div>
            </div>

            <!-- Daily Totals Summary -->
            <div class="daily-summary glass-card" id="daily-summary">
                <h2 class="summary-title">Resumen Diario</h2>
                <div class="summary-grid">
                    <div class="summary-item calories">
                        <div class="summary-icon">üî•</div>
                        <div class="summary-value" id="total-calories">0</div>
                        <div class="summary-label">Calor√≠as</div>
                    </div>
                    <div class="summary-item protein">
                        <div class="summary-icon">üí™</div>
                        <div class="summary-value" id="total-protein">0g</div>
                        <div class="summary-label">Prote√≠nas</div>
                    </div>
                    <div class="summary-item carbs">
                        <div class="summary-icon">‚ö°</div>
                        <div class="summary-value" id="total-carbs">0g</div>
                        <div class="summary-label">Carbohidratos</div>
                    </div>
                    <div class="summary-item fats">
                        <div class="summary-icon">ü•ë</div>
                        <div class="summary-value" id="total-fats">0g</div>
                        <div class="summary-label">Grasas</div>
                    </div>
                </div>
                <div class="macro-bar-container">
                    <div class="macro-bar">
                        <div class="macro-bar-protein" id="bar-protein" style="width: 33%"></div>
                        <div class="macro-bar-carbs" id="bar-carbs" style="width: 33%"></div>
                        <div class="macro-bar-fats" id="bar-fats" style="width: 34%"></div>
                    </div>
                    <div class="macro-bar-labels">
                        <span class="label-protein">Prote√≠nas <span id="pct-protein">33%</span></span>
                        <span class="label-carbs">Carbohidratos <span id="pct-carbs">33%</span></span>
                        <span class="label-fats">Grasas <span id="pct-fats">34%</span></span>
                    </div>
                </div>
            </div>

            <!-- Meals Container -->
            <div class="meals-container" id="meals-container">
                <!-- Meals will be rendered by JS -->
            </div>

            <button class="btn btn-primary btn-add-meal" id="btn-add-meal">
                <svg width="20" height="20" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2.5"
                    stroke-linecap="round">
                    <line x1="12" y1="5" x2="12" y2="19" />
                    <line x1="5" y1="12" x2="19" y2="12" />
                </svg>
                Agregar Comida
            </button>
        </section>

        <!-- ==================== SECTION: ALIMENTOS ==================== -->
        <section class="section" id="section-foods">
            <div class="section-header">
                <h1>Mis Alimentos</h1>
                <p class="section-subtitle">Registr√° los alimentos con su informaci√≥n nutricional por cada 100g</p>
            </div>

            <!-- Add Food Form -->
            <div class="glass-card food-form-card">
                <h2>Agregar Nuevo Alimento</h2>
                <form class="food-form" id="food-form">
                    <div class="form-row">
                        <div class="form-group flex-2">
                            <label for="food-name">Nombre del alimento</label>
                            <input type="text" id="food-name" placeholder="Ej: Pechuga de pollo" required>
                        </div>
                        <div class="form-group">
                            <label for="food-category">Categor√≠a</label>
                            <select id="food-category">
                                <option value="proteinas">ü•© Prote√≠nas</option>
                                <option value="carbohidratos">üçö Carbohidratos</option>
                                <option value="grasas">ü•ë Grasas</option>
                                <option value="frutas">üçé Frutas</option>
                                <option value="verduras">ü•¨ Verduras</option>
                                <option value="lacteos">ü•õ L√°cteos</option>
                                <option value="otros">üçΩÔ∏è Otros</option>
                            </select>
                        </div>
                    </div>
                    <div class="form-row">
                        <div class="form-group">
                            <label for="food-calories">Calor√≠as <small>(por 100g)</small></label>
                            <input type="number" id="food-calories" placeholder="0" min="0" step="0.1" required>
                        </div>
                        <div class="form-group">
                            <label for="food-protein">Prote√≠nas (g) <small>(por 100g)</small></label>
                            <input type="number" id="food-protein" placeholder="0" min="0" step="0.1" required>
                        </div>
                        <div class="form-group">
                            <label for="food-carbs">Carbohidratos (g) <small>(por 100g)</small></label>
                            <input type="number" id="food-carbs" placeholder="0" min="0" step="0.1" required>
                        </div>
                        <div class="form-group">
                            <label for="food-fats">Grasas (g) <small>(por 100g)</small></label>
                            <input type="number" id="food-fats" placeholder="0" min="0" step="0.1" required>
                        </div>
                    </div>
                    <button type="submit" class="btn btn-primary" id="btn-add-food">
                        <svg width="18" height="18" viewBox="0 0 24 24" fill="none" stroke="currentColor"
                            stroke-width="2.5" stroke-linecap="round">
                            <line x1="12" y1="5" x2="12" y2="19" />
                            <line x1="5" y1="12" x2="19" y2="12" />
                        </svg>
                        Agregar Alimento
                    </button>
                </form>
            </div>

            <!-- Food List -->
            <div class="food-list-header">
                <h2>Alimentos Registrados</h2>
                <div class="food-filters">
                    <button class="filter-btn active" data-filter="all">Todos</button>
                    <button class="filter-btn" data-filter="proteinas">ü•© Prote√≠nas</button>
                    <button class="filter-btn" data-filter="carbohidratos">üçö Carbos</button>
                    <button class="filter-btn" data-filter="grasas">ü•ë Grasas</button>
                    <button class="filter-btn" data-filter="frutas">üçé Frutas</button>
                    <button class="filter-btn" data-filter="verduras">ü•¨ Verduras</button>
                    <button class="filter-btn" data-filter="lacteos">ü•õ L√°cteos</button>
                    <button class="filter-btn" data-filter="otros">üçΩÔ∏è Otros</button>
                </div>
            </div>
            <div class="food-grid" id="food-grid">
                <!-- Food cards rendered by JS -->
            </div>
        </section>

        <!-- ==================== SECTION: CALCULADORA IA ==================== -->
        <section class="section" id="section-calculator">
            <div class="section-header">
                <h1>Calculadora Inteligente</h1>
                <p class="section-subtitle">Seleccion√° una comida y los alimentos disponibles. La IA calcular√° las
                    porciones √≥ptimas.</p>
            </div>

            <!-- Step 1: Select meal -->
            <div class="calc-step glass-card" id="calc-step-1">
                <div class="step-header">
                    <div class="step-number">1</div>
                    <div>
                        <h2>Seleccion√° la comida</h2>
                        <p>Eleg√≠ para qu√© comida quer√©s calcular las porciones</p>
                    </div>
                </div>
                <div class="meal-selector" id="meal-selector">
                    <!-- Rendered by JS -->
                </div>
            </div>

            <!-- Step 2: Select available foods -->
            <div class="calc-step glass-card" id="calc-step-2">
                <div class="step-header">
                    <div class="step-number">2</div>
                    <div>
                        <h2>Seleccion√° los alimentos disponibles</h2>
                        <p>Marc√° los alimentos que ten√©s disponibles para esta comida</p>
                    </div>
                </div>
                <div class="available-foods-grid" id="available-foods-grid">
                    <!-- Rendered by JS -->
                </div>
            </div>

            <!-- Step 3: Calculate Button -->
            <div class="calc-action">
                <button class="btn btn-calculate" id="btn-calculate" disabled>
                    <svg width="22" height="22" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"
                        stroke-linecap="round" stroke-linejoin="round">
                        <polygon points="13 2 3 14 12 14 11 22 21 10 12 10 13 2" />
                    </svg>
                    Calcular Porciones √ìptimas
                </button>
            </div>

            <!-- Results -->
            <div class="calc-results glass-card hidden" id="calc-results">
                <div class="results-header">
                    <div class="results-icon">üß†</div>
                    <div>
                        <h2>Resultado del C√°lculo</h2>
                        <p id="results-meal-name">-</p>
                    </div>
                </div>

                <div class="results-comparison" id="results-comparison">
                    <!-- Rendered by JS -->
                </div>

                <div class="results-portions" id="results-portions">
                    <!-- Rendered by JS -->
                </div>

                <div class="results-accuracy" id="results-accuracy">
                    <!-- Rendered by JS -->
                </div>
            </div>
        </section>
    </main>

    <!-- Toast Notifications -->
    <div class="toast-container" id="toast-container"></div>

    <!-- Modal for editing -->
    <div class="modal-overlay hidden" id="modal-overlay">
        <div class="modal glass-card" id="modal">
            <div class="modal-header">
                <h2 id="modal-title">Editar</h2>
                <button class="modal-close" id="modal-close">&times;</button>
            </div>
            <div class="modal-body" id="modal-body">
                <!-- Dynamic content -->
            </div>
        </div>
    </div>

    <script src="app.js"></script>
    <script src="import.js"></script>
</body>

</html>